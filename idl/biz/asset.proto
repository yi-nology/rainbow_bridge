syntax = "proto3";

package asset;
import "api.proto";
import "common.proto";

// ListAssetRequest is used to list assets.
message ListAssetRequest {
  string environment_key = 1;
  string pipeline_key = 2;
}

// AssetData is the data wrapper for a single asset.
message AssetData {
  common.FileAsset asset = 1;
  string reference = 2;
}

// AssetListData is the data wrapper for asset list.
message AssetListData {
  int32 total = 1;
  repeated common.FileAsset list = 2;
}

// AssetListResponse is a unified response for asset list.
// Format: { code, msg, data: { total, list } }
message AssetListResponse {
  int32 code = 1;
  string msg = 2;
  string error = 3;
  AssetListData data = 4;
}

// UploadAssetResponse is a unified response for asset upload.
// Format: { code, msg, data: { asset, reference } }
message UploadAssetResponse {
  int32 code = 1;
  string msg = 2;
  string error = 3;
  AssetData data = 4;
}

// GetFileRequest is used to get a file by ID.
message GetFileRequest {
  string file_id = 1;
}

// AssetService handles file asset operations.
service AssetService {
  // List returns a list of assets for a business.
  rpc List(ListAssetRequest) returns (AssetListResponse) {
    option (api.get) = "/api/v1/asset/list";
  }

  // Upload uploads a new asset file.
  // Note: This endpoint accepts multipart/form-data, not JSON.
  rpc Upload(ListAssetRequest) returns (UploadAssetResponse) {
    option (api.post) = "/api/v1/asset/upload";
  }

  // GetFile retrieves a file by its ID.
  rpc GetFile(GetFileRequest) returns (common.OperateResponse) {
    option (api.get) = "/api/v1/asset/file/{file_id}";
  }
}
