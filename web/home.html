<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>虹桥计划 · 项目概览</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="layout">
      <aside id="sidebar" class="sider"></aside>

      <div class="content">
        <header id="pageHeader"></header>
        <main class="main home">
          <section class="panel compact">
            <h2>项目简介</h2>
            <p>
              <strong>虹桥计划（Rainbow Bridge）</strong> 是一个轻量级、自部署的前端资源配置中台，专为多环境、多渠道场景设计。
              基于 <strong>CloudWeGo Hertz</strong> 框架构建，支持 SQLite/MySQL/PostgreSQL 数据库，开箱即用。
            </p>
            
            <h3>核心能力</h3>
            <ul class="guide-list compact-grid">
              <li><strong>环境隔离：</strong>支持 dev/test/prod 等多环境配置隔离</li>
              <li><strong>渠道管理：</strong>支持多条渠道并行，满足 A/B 测试</li>
              <li><strong>实时与静态：</strong>提供实时接口和静态资源包导出</li>
              <li><strong>配置迁移：</strong>一键导出/导入，快速环境同步</li>
              <li><strong>资源管理：</strong>集中管理静态资源，自动生成 URL</li>
            </ul>
          </section>

          <section class="panel compact">
            <h2>前端对接</h2>
            
            <div class="triple-column">
              <div>
                <h3>概览接口</h3>
                <ul class="guide-list compact">
                  <li><strong>接口：</strong><code data-endpoint="overview">/api/v1/runtime/overview</code></li>
                  <li><strong>返回：</strong>环境与渠道的树形结构</li>
                  <li><strong>场景：</strong>用于动态构建环境/渠道选择器</li>
                </ul>
              </div>
              <div>
                <h3>实时接口（推荐）</h3>
                <ul class="guide-list compact">
                  <li><strong>接口：</strong><code data-endpoint="runtime">/api/v1/runtime/config</code></li>
                  <li><strong>请求：</strong>Header 传 <code>x-environment</code>, <code>x-pipeline</code></li>
                  <li><strong>场景：</strong>需要实时获取最新配置的应用</li>
                </ul>
              </div>
              <div>
                <h3>静态导出</h3>
                <ul class="guide-list compact">
                  <li><strong>接口：</strong><code data-endpoint="static">/api/v1/runtime/static</code></li>
                  <li><strong>参数：</strong><code>?environment_key=xxx&pipeline_key=xxx</code></li>
                  <li><strong>场景：</strong>离线部署、静态托管、CDN 分发</li>
                </ul>
              </div>
            </div>
          </section>

          <section class="panel compact" id="runtimePanel">
            <div class="panel-header">
              <h2>运行时配置</h2>
              <button id="exportStaticBtn" class="primary">导出静态资源</button>
            </div>
            <div class="runtime-controls">
              <div class="control-group">
                <label for="envSelector">环境:</label>
                <select id="envSelector" class="runtime-selector">
                  <option value="">加载中...</option>
                </select>
              </div>
              <div class="control-group">
                <label for="pipelineSelector">渠道:</label>
                <select id="pipelineSelector" class="runtime-selector">
                  <option value="">加载中...</option>
                </select>
              </div>
              <button id="refreshRuntimeBtn" class="ghost">刷新</button>
            </div>
            <p id="runtimeStatus" class="runtime-status">配置加载中…</p>
            <div class="runtime-config-display compact">
              <div class="table-wrapper">
                <table>
                  <thead>
                    <tr>
                      <th>名称</th>
                      <th>别名</th>
                      <th>类型</th>
                      <th>内容</th>
                    </tr>
                  </thead>
                  <tbody id="runtimeConfigTbody"></tbody>
                </table>
                <div id="runtimeConfigEmpty" class="empty hidden">暂无配置数据</div>
              </div>
            </div>
          </section>

          <section class="panel compact">
            <div class="resource-links">
              <a class="primary" href="index.html">进入配置管理</a>
              <a class="ghost" href="https://github.com/yi-nology/rainbow_bridge" target="_blank">GitHub</a>
            </div>
            
            <div id="versionInfo" class="version-info" style="margin-top: 16px; padding: 12px; background: #f5f5f5; border-radius: 4px; font-size: 13px; color: #666;">
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                <span style="font-weight: 500;">当前版本：</span>
                <span id="versionText">加载中...</span>
              </div>
              <div style="display: flex; align-items: center; gap: 8px;">
                <span style="font-weight: 500;">最新版本：</span>
                <span id="latestVersionText">加载中...</span>
              </div>
            </div>
          </section>
        </main>
      </div>
    </div>
    <script type="module" src="./home.js"></script>
  </body>
</html>
